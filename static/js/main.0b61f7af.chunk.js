(this["webpackJsonpvoting-app"]=this["webpackJsonpvoting-app"]||[]).push([[0],{236:function(e,t){},322:function(e,t,n){e.exports=n(521)},323:function(e,t,n){},347:function(e,t){},349:function(e,t){},359:function(e,t){},361:function(e,t){},403:function(e,t){},404:function(e,t){},409:function(e,t){},411:function(e,t){},435:function(e,t){},521:function(e,t,n){"use strict";n.r(t);n(323);var a,r=n(0),o=n.n(r),c=n(13),i=n.n(c),l=n(26),u=function(e){a=e.error};function s(e){var t="string"===typeof e?e:e.toString();u({error:t})}function d(){u({})}var p=r.createContext({setError:s,clearError:d}),m=function(){return r.useContext(p)};function f(e){var t=r.useState({}),n=Object(l.a)(t,2),o=n[0],c=n[1];u=c,a&&(c({error:a}),a=void 0);var i={error:o.error,setError:s,clearError:d};return r.createElement(p.Provider,{value:i},e.children)}var h=n(6),b=n.n(h),g=n(21),x=n(291),v=n(60),E=n(61),k={httpUrl:"https://lcd.coralnet.cosmwasm.com",feeToken:"ushell",gasPrice:.025,faucetUrl:"https://faucet.coralnet.cosmwasm.com/credit",faucetToken:"SHELL",addressPrefix:"coral",codeId:7};function w(e){var t=e.feeToken,n=e.gasPrice,a=function(e,t,n){return{amount:[{amount:Math.floor(e*n).toString(),denom:t}],gas:e.toString()}};return{upload:a(15e5,t,n),init:a(6e5,t,n),exec:a(2e5,t,n),migrate:a(6e5,t,n),send:a(8e4,t,n),changeAdmin:a(8e4,t,n)}}function y(){var e="burner-wallet",t=localStorage.getItem(e);if(t)return t;var n=v.Bip39.encode(v.Random.getBytes(16)).toString();return localStorage.setItem(e,n),n}function j(e){return O.apply(this,arguments)}function O(){return(O=Object(g.a)(b.a.mark((function e(t){var n,a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=y(),a=Object(E.makeCosmoshubPath)(0),e.next=4,E.Secp256k1Wallet.fromMnemonic(n,a,t);case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(){return(S=Object(g.a)(b.a.mark((function e(t,n){var a,r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getAccounts();case 2:return a=e.sent[0].address,r=w(k),e.abrupt("return",new x.SigningCosmWasmClient(t,a,n,r));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var C={initialized:!1,address:"",getClient:function(){throw new Error("not yet initialized")}},F=r.createContext(C),I=function(){return r.useContext(F)};function P(e){var t=e.config,n=e.children;return r.createElement(T,{config:t,loadWallet:j},n)}function T(e){var t=e.config,n=e.loadWallet,a=e.children,o=Object(r.useState)(C),c=Object(l.a)(o,2),i=c[0],u=c[1];return Object(r.useEffect)((function(){n(t.addressPrefix).then((function(e){return function(e,t){return S.apply(this,arguments)}(t.httpUrl,e)})).then(function(){var e=Object(g.a)(b.a.mark((function e(n){var a,r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.senderAddress,!t.faucetUrl){e.next=8;break}return e.next=4,n.getAccount();case 4:if(null===(o=e.sent)||void 0===o||null===(r=o.balance)||void 0===r?void 0:r.length){e.next=8;break}return e.next=8,fetch(t.faucetUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({ticker:t.faucetToken,address:a})});case 8:u({initialized:!0,address:a,getClient:function(){return n}});case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[t.addressPrefix,t.faucetToken,t.faucetUrl,t.httpUrl,n]),r.createElement(F.Provider,{value:i},a)}var H=r.createContext({refreshAccount:function(){}}),B=function(){return r.useContext(H)};function q(e){var t=e.children,n=m().setError,a=I(),o=r.useState({}),c=Object(l.a)(o,2),i=c[0],u=c[1];function s(){a.initialized&&a.getClient().getAccount().then((function(e){return u({account:e})})).catch(n)}r.useEffect(s,[a,n]);var d={refreshAccount:s,account:i.account};return r.createElement(H.Provider,{value:d},t)}var _=r.createContext({refreshBlockHeight:function(){}}),A=function(){return r.useContext(_)};function W(e){var t=e.children,n=m().setError,a=I(),o=r.useState({}),c=Object(l.a)(o,2),i=c[0],u=c[1];function s(){a.initialized&&a.getClient().getHeight().then((function(e){return u({blockHeight:e})})).catch(n)}r.useEffect(s,[a,n]);var d={refreshBlockHeight:s,blockHeight:i.blockHeight};return r.createElement(_.Provider,{value:d},t)}var z=n(571),M=n(569),N=Object(M.a)({root:{height:"40px",width:"100%",background:"#ebf5fc",border:"none",outline:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"20px",fontWeight:500,color:"#3d5af1",boxShadow:"-2px -2px 6px rgba(255, 255, 255, 1), 2px 2px 6px rgba(0, 0, 0, 0.1)","&:hover":{boxShadow:"-2px -2px 6px rgba(255, 255, 255, 1), 2px 2px 6px rgba(0, 0, 0, 0.1)",background:"#ebf5fc"},"&:active":{boxShadow:"inset -2px -2px 6px rgba(255, 255, 255, 1), inset 2px 2px 6px rgba(0, 0, 0, 0.1)",background:"#ebf5fc"}}});function R(e){var t=N();return r.createElement(z.a,Object.assign({disableElevation:!0,disableFocusRipple:!0,disableRipple:!0,className:t.root},e))}var D=n(601),L=n(573);function V(e){var t=e.error,n=e.clearError;return r.createElement(D.a,{severity:"error",onClose:n},r.createElement(L.a,null,"Error"),t)}var U=n(575),G=n(576),J=n(523),Q=n(82),Y=n(574),$=n(603),K=n(106),X=n(42),Z=n(602),ee=Object(M.a)((function(e){var t,n,a;return Object(Z.a)({contractLogicContainer:{display:"flex",flexDirection:"column",alignItems:"center"},table:{background:"#ebf5fc",boxShadow:"-5px -5px 15px rgba(255, 255, 255, 0.8), 5px 5px 10px rgba(0, 0, 0, 0.1)",borderRadius:"25px"},instructions:{background:"#ebf5fc",boxShadow:"-5px -5px 15px rgba(255, 255, 255, 0.8), 5px 5px 10px rgba(0, 0, 0, 0.1)",borderRadius:"25px"},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"},heading:{background:"#ebf5fc",boxShadow:"-5px -5px 15px rgba(255, 255, 255, 0.8), 5px 5px 10px rgba(0, 0, 0, 0.1)",borderRadius:"25px"},card:(n={width:"80vw",margin:"10px",padding:"20px",background:"#ebf5fc",boxShadow:"-5px -5px 15px rgba(255, 255, 255, 0.8), 5px 5px 10px rgba(0, 0, 0, 0.1)",borderRadius:"25px",minWidth:"800px","& ul":Object(X.a)({listStyleType:"none",padding:"0",margin:"0"},e.breakpoints.up("sm"),{marginBlockStart:"1em",marginBlockEnd:"1em"}),"& li":(t={display:"grid",gridTemplateColumns:"1fr",fontSize:".75em","& p:first-child":{marginBottom:".2em"},"& p:last-child":{marginTop:".2em"}},Object(X.a)(t,e.breakpoints.up("sm"),{gridTemplateColumns:"25% 75%",fontSize:".9em","& p:first-child":{margin:".5em 0.05em"},"& p:last-child":{margin:".5em 0.05em"}}),Object(X.a)(t,e.breakpoints.up("md"),{gridTemplateColumns:"20% 80%",fontSize:"1em","& p:first-child":{margin:".5em 0.1"},"& p:last-child":{margin:".5em .1em"}}),t),"& li p:first-child":{color:"#3d5af1"}},Object(X.a)(n,e.breakpoints.up("sm"),{width:"75vw",margin:"20px",padding:"30px 20px"}),Object(X.a)(n,e.breakpoints.up("md"),{width:"60vw",padding:"30px 40px"}),n),dashboardContainer:{position:"relative",display:"flex",justifyContent:"center",alignItems:"center"},root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},blockHeight:{padding:e.spacing(1),marginLeft:e.spacing(50),flexGrow:1},account:{padding:e.spacing(1)},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"},content:{flexGrow:1,padding:e.spacing(3)},listCard:(a={flexDirection:"column-reverse",textAlign:"center",width:"95vw",margin:"5px",padding:"10px 5px",borderRadius:"116px",background:"#ebf5fc",boxShadow:"-5px -5px 15px rgba(255, 255, 255, 0.8), 5px 5px 10px rgba(0, 0, 0, 0.1)","&:hover":{boxShadow:"inset -5px -5px 10px rgba(255,255,255,0.5), inset 5px 5px 10px rgba(0,0,0,0.05)"},"& .MuiListItemText-secondary":{fontSize:"13px"}},Object(X.a)(a,e.breakpoints.up("sm"),{width:"70vw",margin:"20px",padding:"30px 40px","& .MuiListItemText-secondary":{fontSize:"14px"}}),Object(X.a)(a,e.breakpoints.up("md"),{flexDirection:"row",textAlign:"left",width:"60vw","& .MuiListItemText-secondary":{fontSize:"15px"}}),a),link:{textDecoration:"none",color:"#3d5af1"},createPollDialog:{background:"#ebf5fc",height:"550px"},createPollTitle:{background:"#ebf5fc"},createPollForm:Object(X.a)({background:"#ebf5fc",boxShadow:"-5px -5px 5px rgba(255, 255, 255, 0.8), 5px 5px 10px rgba(0, 0, 0, 0.1)",display:"flex",justifyContent:"space-around",padding:"10px","& p":{fontSize:"0.75rem"},"& .MuiFormHelperText-root.Mui-error":{marginTop:"0"}},e.breakpoints.up("sm"),{height:"440px",width:"350px",justifyContent:"space-around",margin:"20px",padding:"20px","& p":{fontSize:"1rem"},"& .MuiFormHelperText-root.Mui-error":{marginTop:"3px"}}),form:Object(X.a)({background:"#ebf5fc",boxShadow:"-5px -5px 15px rgba(255, 255, 255, 0.8), 5px 5px 10px rgba(0, 0, 0, 0.1)",borderRadius:"25px",display:"flex",flexDirection:"column",justifyContent:"space-around",padding:"10px","& p":{fontSize:"0.75rem"},"& .MuiFormHelperText-root.Mui-error":{marginTop:"0"}},e.breakpoints.up("sm"),{height:"250px",justifyContent:"space-around",margin:"20px",padding:"20px","& p":{fontSize:"1rem"},"& .MuiFormHelperText-root.Mui-error":{marginTop:"3px"}}),tokenOps:{background:"#ebf5fc",minWidth:"130px",borderRadius:"25px",maxWidth:"200px",display:"flex",flexDirection:"column",justifyContent:"space-around"},tokenForm:Object(X.a)({background:"#ebf5fc",display:"flex",flexDirection:"column","& p":{fontSize:"0.75rem"},"& .MuiFormHelperText-root.Mui-error":{marginTop:"0"}},e.breakpoints.up("sm"),{justifyContent:"space-around",margin:"5px",padding:"10px","& p":{fontSize:"1rem"},"& .MuiFormHelperText-root.Mui-error":{marginTop:"3px"}}),pollInput:{display:"flex","& input":{minWidth:"100px"}},quorumCol:{display:"flex",minWidth:"40px"},tokenOpsInput:{display:"flex","& input":{height:"30px",background:"#ebf5fc",border:"none",outline:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"14px",color:"#3d5af1",boxShadow:"inset -2px -2px 6px rgba(255, 255, 255, 1), inset 2px 2px 6px rgba(0, 0, 0, 0.1);"}},input:{display:"flex","& input":{height:"30px",width:"100%",background:"#ebf5fc",border:"none",outline:"none",borderRadius:"20px",padding:"5px 15px",fontSize:"18px",color:"#3d5af1",boxShadow:"inset -2px -2px 6px rgba(255, 255, 255, 1), inset 2px 2px 6px rgba(0, 0, 0, 0.1);"}},createPollCancel:{width:"50%",color:"secondary",padding:"15px 15px"},createPollSubmit:{width:"50%",padding:"15px 15px"},createPollInput:{display:"flex","& input":{height:"25px",background:"#ebf5fc",border:"none",outline:"none",padding:"15px 15px",fontSize:"14px",color:"#3d5af1",boxShadow:"inset -2px -2px 6px rgba(255, 255, 255, 1), inset 2px 2px 6px rgba(0, 0, 0, 0.1);"}},bottomSpacer:{marginBottom:"8px"}})})),te=n(70);function ne(e){return e?ae(e.denom,e.amount):"0"}function ae(e,t){if(!t)return"0";if(e.startsWith("u")){var n=e.slice(1).toUpperCase();return te.Decimal.fromAtomics(t,6).toString()+"\u202f"+n}return t+"\u202f"+e}function re(){var e=ee(),t=A().blockHeight;return o.a.createElement(Q.a,{variant:"h6",className:e.blockHeight}," Latest Block Height: ",t," ")}function oe(e){var t=e.children,n=Object(Y.a)({disableHysteresis:!0,threshold:0});return r.cloneElement(t,{elevation:n?4:0})}function ce(e,t){var n=e.account,a=(e.children,n?function(e){return e&&0!==e.length?e.map(ne).join(", "):"\u2013"}(n.balance):"(Loading Balance)"),o=n?n.address:"(No Address)",c=ee();return r.createElement(r.Fragment,null,r.createElement(oe,t,r.createElement(U.a,{position:"fixed",className:c.appBar},r.createElement(G.a,null,r.createElement(K.b,{to:"/",className:c.account},r.createElement(J.a,{edge:"start",color:"inherit"},r.createElement($.a,null))),r.createElement(Q.a,{variant:"h6"},o," - ",a),r.createElement(re,null)))),r.createElement(G.a,null))}function ie(){return r.createElement(Q.a,{variant:"h2"},"Loading Wallet...")}var le=n(577),ue=Object(M.a)((function(e){return Object(Z.a)({root:{flexGrow:1,height:"102vh",background:"#ebf5fc"}})}));function se(e){var t=e.children,n=ue();return r.createElement(le.a,{className:n.root,container:!0,spacing:3,justify:"center"},r.createElement(le.a,{item:!0,xs:12,sm:10,md:8},t))}var de=function(){var e=m(),t=e.error,n=e.clearError;return t?r.createElement(V,{error:t,clearError:n}):r.createElement("div",null)};var pe=function(e){return I().initialized?r.createElement(se,null,e.children):r.createElement(r.Fragment,null,r.createElement(ie,null),r.createElement(de,null))},me=n(14),fe=n(581),he=n(604),be=n(578),ge=n(579),xe=n(580),ve=n(292),Ee=n.n(ve);function ke(e){var t=e.address,n=e.label,a=ee();return r.createElement("div",{className:a.dashboardContainer},r.createElement(K.b,{className:a.link,to:"/contract/".concat(t)},r.createElement(be.a,{className:a.listCard},r.createElement(ge.a,null,r.createElement(he.a,null,r.createElement(Ee.a,null))),r.createElement(xe.a,{primary:n,secondary:t}))))}var we=k.codeId;var ye=function(){var e=I().getClient,t=m().setError,n=r.useState([]),a=Object(l.a)(n,2),o=a[0],c=a[1];return r.useEffect((function(){e().getContracts(we).then((function(e){return c(e)})).catch(t)}),[e,t]),r.createElement(fe.a,null,o.map((function(e){return r.createElement(ke,Object.assign({},e,{key:e.address}))})))};var je=function(){var e=B().account;return r.createElement(ce,{account:e})},Oe=n(9),Se=n(57),Ce=n(301),Fe=n(599),Ie=function(e){var t=e.type,n=e.placeholder,a=e.InputProps,o=Object(Ce.a)(e,["type","placeholder","InputProps"]),c=Object(Se.c)(o),i=Object(l.a)(c,2),u=i[0],s=i[1],d=s.error&&s.touched?s.error:"";return"number"===t?r.createElement(Fe.a,Object.assign({id:"outlined-number",type:t,label:n,InputProps:a},u,{helperText:d,error:!!d})):r.createElement(Fe.a,Object.assign({type:t,placeholder:n,InputProps:a,fullWidth:!0},u,{helperText:d,error:!!d}))},Pe=n(52),Te=Pe.b().shape({withdrawAmountField:Pe.a().min(1e-6,"Invalid withdraw amount")}),He=Pe.b().shape({stakeAmountField:Pe.a().min(1e-6,"Invalid stake amount")}),Be=Pe.b().shape({descriptionField:Pe.c().min(3,"Min length").max(64,"Max length").required("Required"),quorumField:Pe.a().min(0,"Invalid quorum").max(100,"Invalid quorum").required("Required"),startHeightField:Pe.a(),endHeightField:Pe.a()}),qe=(Pe.b().shape({weightField:Pe.a().min(1,"Invalid weight").required("Weight required")}),function(e){var t=e.handleStake,n=e.tokenBalance,a=ee();return r.createElement(Se.b,{initialValues:{stakeAmountField:""},validationSchema:He,onSubmit:function(){var e=Object(g.a)(b.a.mark((function e(n,a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.stakeAmountField,(0,a.setSubmitting)(!0),t({stakeAmountField:r});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},(function(e){var t=e.handleSubmit;return r.createElement(Se.a,{onSubmit:t,className:a.tokenForm},r.createElement("div",{className:a.tokenOpsInput},r.createElement(Ie,{placeholder:"0",name:"stakeAmountField",type:"text"})),r.createElement("div",null,r.createElement(R,{type:"submit",disabled:!n},"Stake")))}))}),_e=function(e){var t=e.handleWithdraw,n=e.stakedBalance,a=ee();return r.createElement(Se.b,{initialValues:{withdrawAmountField:""},validationSchema:Te,onSubmit:function(){var e=Object(g.a)(b.a.mark((function e(n,a){var r;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.withdrawAmountField,(0,a.setSubmitting)(!0),t({withdrawAmountField:r});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},(function(e){var t=e.handleSubmit;return r.createElement(Se.a,{onSubmit:t,className:a.tokenForm},r.createElement("div",{className:a.tokenOpsInput},r.createElement(Ie,{placeholder:"0",name:"withdrawAmountField",type:"text"})),r.createElement("div",null,r.createElement(R,{type:"submit",disabled:!n},"Withdraw")))}))},Ae=n(582);function We(e){var t=e.denom,n=e.tokenBalance,a=e.stakedBalance;return r.createElement("div",null,r.createElement(Q.a,{variant:"h6"},"Dashboard"),r.createElement(le.a,{container:!0,spacing:10,justify:"space-between"},r.createElement(le.a,{item:!0,xs:6},r.createElement(Ae.a,null,"Staked Tokens: ",a&&ae(t,String(a)))),r.createElement(le.a,{item:!0,xs:6},r.createElement(Ae.a,null,"Token Balance: ",n&&function(e,t){if(!t||0===t.length)return"\u2013";var n=t.filter((function(t){return t.denom===e})).map(ne);return n.length>0?n[0]:""}(t,Object(E.coins)(parseInt(n,10),t))))))}var ze=n(584),Me=n(586),Ne=n(585),Re=n(587),De=function(e){var t=e.handleCreatePoll,n=e.loading,a=ee(),o=r.useState(!1),c=Object(l.a)(o,2),i=c[0],u=c[1],s=function(){u(!1)};return r.createElement("div",null,r.createElement(R,{type:"submit",disabled:n,onClick:function(){u(!0)}},"Create New Poll"),r.createElement(ze.a,{open:i,onClose:s,"aria-labelledby":"form-dialog-title"},r.createElement(Ne.a,{className:a.createPollTitle,id:"form-dialog-title"},"Create New Poll"),r.createElement(Me.a,{className:a.createPollDialog},r.createElement(Se.b,{initialValues:{quorumField:"",descriptionField:"",startHeightField:"",endHeightField:""},validationSchema:Be,onSubmit:function(){var e=Object(g.a)(b.a.mark((function e(n,a){var r,o,c,i;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.quorumField,o=n.descriptionField,c=n.startHeightField,i=n.endHeightField,(0,a.setSubmitting)(!0),t({quorumField:r,descriptionField:o,startHeightField:c,endHeightField:i}),s();case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},(function(e){var t=e.handleSubmit;return r.createElement(Se.a,{onSubmit:t,className:a.createPollForm},r.createElement("div",{className:a.createPollInput},r.createElement(le.a,{container:!0,direction:"row"},r.createElement(le.a,{item:!0,xs:12},r.createElement(Re.a,{control:r.createElement(Ie,{placeholder:"",name:"quorumField",type:"number",required:!0}),label:"Quorum",labelPlacement:"end"})),r.createElement(le.a,{item:!0,xs:12},r.createElement(Re.a,{control:r.createElement(Ie,{placeholder:"",name:"descriptionField",type:"text",required:!0}),label:"Description",labelPlacement:"end"})),r.createElement(le.a,{item:!0,xs:12},r.createElement(Re.a,{control:r.createElement(Ie,{placeholder:"",name:"startHeightField",type:"number"}),label:"Start height",labelPlacement:"end"})),r.createElement(le.a,{item:!0,xs:12},r.createElement(Re.a,{control:r.createElement(Ie,{placeholder:"",name:"endHeightField",type:"number"}),label:"End height",labelPlacement:"end"})),r.createElement(le.a,{item:!0,xs:5},r.createElement(R,{type:"reset",onClick:s},"Cancel")),r.createElement(le.a,{item:!0,xs:5},r.createElement(R,{type:"submit",disabled:n},"Create")))))})))))},Le=n(168),Ve=n(606),Ue=n(589),Ge=n(590),Je=n(296),Qe=n.n(Je),Ye=n(297),$e=n.n(Ye),Ke=n(591);function Xe(e){var t=ee();return o.a.createElement("div",null,o.a.createElement(Ve.a,{className:t.instructions},o.a.createElement(Ue.a,{expandIcon:o.a.createElement(Qe.a,null),"aria-controls":"instructions-content",id:"instructions-header"},o.a.createElement(Q.a,{variant:"h6"},"Instructions"),o.a.createElement($e.a,null)),o.a.createElement(Ge.a,null,o.a.createElement(Q.a,null,"Welcome to Privote, a privacy-first voting app on Secret Network.",o.a.createElement("br",null),"This platform allows users to create pools with parameters like participation threshold (quorum) and vote duration.",o.a.createElement("br",null),"Once a pool is created, any participant can stake SCRT to vote on the pool in a privacy-preserving manner.",o.a.createElement("br",null),"This means users can prove they voted, but their vote will remain encrypted. Secret voting is critical for mitigating bribery attacks.",o.a.createElement("br",null),"For more on secret voting and why you should care, please read our blog post (TBD)",o.a.createElement("br",null),o.a.createElement(Ke.a,{href:"https://learn.scrt.network/questions.html"},"Secret Network FAQ")))))}var Ze=n(524),et=n(592);function tt(e){var t=e.loading,n=ee();return o.a.createElement("div",null,o.a.createElement(Ze.a,{className:n.backdrop,open:t},o.a.createElement(et.a,{color:"inherit"})))}var nt=n(600),at=n(4),rt=n(596),ot=n(598),ct=n(593),it=n(595),lt=n(597),ut=n(594),st=n(303),dt=n(299),pt=n.n(dt),mt=n(300),ft=n.n(mt),ht=n(298),bt=n.n(ht);function gt(e){var t=e.loading,n=e.address,a=e.poll,c=e.handleTallyPoll,i=e.handleRefreshPoll,l=e.blockHeight;Object(r.useEffect)((function(){var e=setInterval((function(){i(a)}),5e3);return function(){return clearInterval(e)}}),[]);var u=function(){return s()&&!t&&p()&&d()},s=function(){return!a.endHeight||a.endHeight<l},d=function(){return"InProgress"===a.status},p=function(){return a.creator===n};return o.a.createElement("div",null,u()&&d()&&o.a.createElement(J.a,{type:"submit",disabled:!u(),onClick:function(e){return c(a)}},o.a.createElement(bt.a,null)),!d()&&!p()&&a.status,!u()&&p()&&a.status)}var xt=Object(at.a)((function(e){return{head:{fontSize:15,fontWeight:"bold"},body:{fontSize:14}}}))(ct.a),vt=Object(at.a)((function(e){return{root:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover}}}}))(ut.a);function Et(e){var t=ee(),n=I().address,a=e.handleCastVote,r=e.handleTallyPoll,c=e.handleRefreshPoll,i=e.loading,u=e.poll,s=e.blockHeight,d=e.stakedBalance,p=o.a.useState({}),m=Object(l.a)(p,2),f=m[0],h=m[1],b=function(){return!!u.endHeight&&u.endHeight<=s},g=function(){return!(!d||!f.pollWeight)&&f.pollWeight<=d},x=function(){var e=f.pollWeight;return!(b()||!e||"InProgress"!==u.status)};return o.a.createElement(vt,{key:u.pollId},o.a.createElement(xt,null,o.a.createElement(J.a,{disabled:!x(),color:"primary",onClick:function(){g()&&!b()&&f.pollWeight&&a("yes",u,f.pollWeight)},"aria-label":"Yea"},o.a.createElement(pt.a,null)),o.a.createElement(J.a,{disabled:!x(),color:"secondary",onClick:function(){g()&&!b()&&f.pollWeight&&a("no",u,f.pollWeight)},"aria-label":"Nay"},o.a.createElement(ft.a,null))),o.a.createElement(xt,{size:"small",align:"left"},o.a.createElement(Fe.a,{className:t.pollInput,name:"weightField",type:"number",disabled:"InProgress"!==u.status,onChange:function(e){return function(e){e.preventDefault();var t=e.target.value;t&&parseInt(t)>0&&parseInt(t)<=d&&h({pollWeight:parseInt(t)})}(e)}})),o.a.createElement(xt,{align:"left",component:"th",scope:"row"},u.description),o.a.createElement(xt,{align:"right"},u.quorum||0),o.a.createElement(xt,{align:"right"},function(){if(u.endHeight){var e=u.endHeight-s;if(e>0){var t=1*e,n=Math.floor(t/86400),a=Math.floor(t%86400/3600),r=Math.floor(t%3600/60),o=Math.floor(t%60);return n>0?"~".concat(n," days ").concat(a,"h"):"".concat(a,"h ").concat(r,"m ").concat(o,"s")}return""}}()),o.a.createElement(xt,{align:"right"},o.a.createElement(gt,{address:n,handleTallyPoll:r,blockHeight:s,loading:i,handleRefreshPoll:c,poll:u})))}var kt=Object(at.a)((function(e){return{head:{fontSize:15,fontWeight:"bold"},body:{fontSize:14}}}))(ct.a);function wt(e){var t=ee(),n=A(),a=n.blockHeight,c=n.refreshBlockHeight,i=e.handleCastVote,l=e.handleTallyPoll,u=e.handleRefreshPoll,s=e.loading,d=e.polls,p=e.contractAddress,m=e.stakedBalance;return Object(r.useEffect)((function(){var e=setInterval((function(){c()}),1e3);return function(){return clearInterval(e)}}),[]),o.a.createElement("div",null,o.a.createElement(it.a,{component:st.a},o.a.createElement(rt.a,{className:t.table,"aria-label":"List of polls"},o.a.createElement(lt.a,null,o.a.createElement(ut.a,null,o.a.createElement(kt,null,"Vote"),o.a.createElement(kt,{align:"left"},"Weight"),o.a.createElement(kt,{align:"left"},"Description"),o.a.createElement(kt,{align:"right"},"Quorum"),o.a.createElement(kt,{align:"right"},"Time remaining"),o.a.createElement(kt,{align:"right"}))),o.a.createElement(ot.a,null,Array.from(d.values()).map((function(e){return o.a.createElement(Et,{stakedBalance:m,contractAddress:p,poll:e,loading:s,handleCastVote:i,handleRefreshPoll:u,handleTallyPoll:l,blockHeight:a||0})}))))))}function yt(e,t,n,a,r,o,c){return{pollId:e,creator:t,description:n,quorum:a,status:r,startHeight:o,endHeight:c}}function jt(e){var t=ee(),n=e.contractAddress,a=e.contract,o=I(),c=o.address,i=o.getClient,u=m().setError,s=B().refreshAccount,d=Object(Le.b)().enqueueSnackbar,p=r.useState({loading:!1}),f=Object(l.a)(p,2),h=f[0],x=f[1],v=function(){var e=Object(g.a)(b.a.mark((function e(t){var r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!0})),r=1e6*parseFloat(t.stakeAmountField),o=[Object(E.coin)(r||0,a.denom||"")],e.prev=3,e.next=6,i().execute(n,{stake_voting_tokens:{}},"",o);case 6:return F("Staked tokens","success"),e.next=9,O();case 9:s(),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),u(e.t0),x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1}));case 16:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(g.a)(b.a.mark((function e(t){var a,r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=1e6*parseFloat(t.withdrawAmountField),r=String(a)||"0",x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!0})),o={withdraw_voting_tokens:{}},parseInt(r)>0&&(o={withdraw_voting_tokens:{amount:r}}),F("Withdrew tokens","success"),e.prev=6,e.next=9,i().execute(n,o);case 9:s(),O(),x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1})),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(6),u(e.t0),x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1}));case 18:case"end":return e.stop()}}),e,null,[[6,14]])})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(g.a)(b.a.mark((function e(t,a,r){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={cast_vote:{weight:String(r),vote:t,poll_id:a.pollId}},x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!0})),e.prev=2,e.next=5,i().execute(n,o);case 5:F("Vote cast","success"),s(),x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1})),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),u(e.t0),x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1}));case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t,n,a){return e.apply(this,arguments)}}(),y=function(){var e=Object(g.a)(b.a.mark((function e(t){var a,r,o,c,l,d;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={end_poll:{poll_id:t.pollId}},x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!0})),e.prev=2,e.next=5,i().execute(n,a);case 5:o=e.sent,c=o.logs[0].events[1].attributes,l=c.find((function(e){return"passed"===e.key})),l&&"true"===l.value?(t.status="Passed",F("Poll passed","success")):(l=c.find((function(e){return"rejected_reason"===e.key})),d=l&&l.value,F("Poll rejected: ".concat(d),"error"),t.status=d),null===(r=h.polls)||void 0===r||r.set(t.pollId,t),s(),x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1})),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),u(e.t0),x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1}));case 19:case"end":return e.stop()}}),e,null,[[2,15]])})));return function(t){return e.apply(this,arguments)}}(),j=function(){var e=Object(g.a)(b.a.mark((function e(t,a,r){var o,c,l;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=new Map,x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!0})),l=b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c,e.next=3,i().queryContractSmart(n,{poll:{poll_id:t}}).then((function(e){var n=e.creator,a=e.status,r=e.quorum_percentage,c=e.description,i=e.end_height,l=e.start_height;o.set(t,yt(t,n,c,r,a,l,i))})).catch((function(e){u(e)}));case 3:case"end":return e.stop()}}),e)})),c=t;case 4:if(!(c>0)){e.next=9;break}return e.delegateYield(l(),"t0",6);case 6:c--,e.next=4;break;case 9:x(Object(Oe.a)(Object(Oe.a)({},h),{},{polls:o,loading:!1,stakedBalance:a,tokenBalance:r,pollCount:t}));case 10:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}();r.useEffect((function(){x({loading:!0}),i().queryContractSmart(n,{token_stake:{address:c}}).then((function(e){return e})).then((function(e){i().queryContractSmart(n,{config:{}}).then((function(t){j(t.poll_count,t.staked_tokens,e.token_balance)}))})).catch((function(e){x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1})),u(e)}))}),[]);var O=function(){var e=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().queryContractSmart(n,{token_stake:{address:c}}).then((function(e){i().queryContractSmart(n,{config:{}}).then((function(t){j(t.poll_count,t.staked_tokens,e.token_balance)}))})).catch((function(e){x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1})),u(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=function(){var e=Object(g.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i().queryContractSmart(n,{poll:{poll_id:t.pollId}}).then((function(e){t.status=e.status})).catch((function(e){u(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var t=Object(g.a)(b.a.mark((function t(a){var r,o,c,l,s,d,p,m,f,g,v;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.quorumField,o=a.descriptionField,c=a.startHeightField,l=a.endHeightField,t.next=6,i().getHeight();case 6:if(s=t.sent,!(l&&parseInt(l)>0)){t.next=16;break}if(s){t.next=13;break}return u("Failed to create poll, error getting block height"),t.abrupt("return");case 13:if(!(s>parseInt(l))){t.next=16;break}return u("Poll cannot end in the past"),t.abrupt("return");case 16:return x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!0})),d={quorum_percentage:parseInt(r),description:o},c&&(p=parseInt(c),d.start_height=p),l&&(m=parseInt(l),d.end_height=m),t.prev=20,t.next=23,i().execute(e.contractAddress,{create_poll:d});case 23:if(f=t.sent,void 0!==(g=f.logs[0].events[1].attributes.find((function(e){return"poll_id"===e.key})))){t.next=29;break}return x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1})),u("failed to create poll"),t.abrupt("return");case 29:return F("Poll created","success"),v=parseInt(g.value),t.next=33,i().queryContractSmart(n,{poll:{poll_id:v}}).then((function(e){var t=e.creator,n=e.status,a=e.quorum_percentage,r=e.description,o=h.polls||new Map;o.set(v,yt(v,t,r,a,n,p,m)),x(Object(Oe.a)(Object(Oe.a)({},h),{},{polls:o}))})).catch((function(e){u(e)}));case 33:t.next=38;break;case 35:t.prev=35,t.t0=t.catch(20),u(t.t0);case 38:x(Object(Oe.a)(Object(Oe.a)({},h),{},{loading:!1}));case 39:case"end":return t.stop()}}),t,null,[[20,35]])})));return function(e){return t.apply(this,arguments)}}();function F(e,t){d(e,{variant:t})}return r.createElement(nt.a,{width:"100%"},r.createElement(nt.a,{width:"100%",p:1,my:.5},r.createElement(Xe,null)),r.createElement("div",{className:t.card},r.createElement(tt,{loading:h.loading}),r.createElement(le.a,{container:!0,spacing:3},r.createElement(le.a,{item:!0,xs:12},a.denom&&r.createElement(We,{denom:a.denom,stakedBalance:h.stakedBalance,tokenBalance:h.tokenBalance})),r.createElement(le.a,{item:!0,xs:12},r.createElement(De,{handleCreatePoll:C,loading:h.loading})),r.createElement(le.a,{item:!0,xs:2},r.createElement(le.a,{container:!0,spacing:1,className:t.tokenOps},r.createElement(Q.a,{variant:"h6"},"Token Operations:"),r.createElement(le.a,{item:!0,xs:12},r.createElement(qe,{handleStake:v,tokenBalance:h.tokenBalance})),r.createElement(le.a,{item:!0,xs:12},r.createElement(_e,{handleWithdraw:k,stakedBalance:h.stakedBalance})))),r.createElement(le.a,{item:!0,xs:10},h.polls&&h.stakedBalance&&r.createElement(wt,{contractAddress:n,polls:h.polls,stakedBalance:h.stakedBalance,loading:h.loading,handleTallyPoll:y,handleCastVote:w,handleRefreshPoll:S})))))}var Ot={address:"",owner:"",stakedTokens:0,pollCount:0,initMsg:{denom:"",name:""}};var St=function(e){var t=e.address,n=I().getClient,a=m().setError,o=r.useState(Ot),c=Object(l.a)(o,2),i=c[0],u=c[1];return r.useEffect((function(){n().getContract(t).then((function(e){u(Object(Oe.a)(Object(Oe.a)({},e),{},{address:t})),n().queryContractSmart(t,{config:{}}).then((function(n){u({address:t,stakedTokens:n.staked_tokens,pollCount:n.poll_count,initMsg:{denom:n.denom,name:e.label}})}))})).catch(a)}),[a,t,n]),r.createElement("div",null,i.initMsg&&i.initMsg.denom&&r.createElement("div",null,r.createElement(jt,{contractAddress:t,owner:i.owner||"",contract:i.initMsg})))};var Ct=function(){var e=Object(me.f)().address;return o.a.createElement(St,{address:e||""})},Ft=function(){return o.a.createElement(K.a,{basename:"/"},o.a.createElement(je,null),o.a.createElement(de,null),o.a.createElement(me.c,null,o.a.createElement(me.a,{exact:!0,path:"/",component:ye}),o.a.createElement(me.a,{exact:!0,path:"/contract/:address",component:Ct})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function It(){return(It=Object(g.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("serviceWorker"in navigator)){e.next=3;break}return e.next=3,navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pt,Tt=document.getElementById("root");Pt=Ft,i.a.render(o.a.createElement(Le.a,{maxSnack:3},o.a.createElement(f,null,o.a.createElement(P,{config:k},o.a.createElement(W,null,o.a.createElement(q,null,o.a.createElement(pe,null,o.a.createElement(Pt,null))))))),Tt),function(){It.apply(this,arguments)}()}},[[322,1,2]]]);
//# sourceMappingURL=main.0b61f7af.chunk.js.map